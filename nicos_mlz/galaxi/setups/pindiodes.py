# -*- coding: utf-8 -*-

description = 'GALAXI PIN diodes'

group = 'optional'

display_order = 20

tango_base = 'tango://localhost:10000/galaxi/'
tango_digital = tango_base + 'fzjdp_digital/'
tango_analog = tango_base + 'plc_io/'

devices = dict(
    pintimer = device('nicos.devices.tango.AnalogOutput',
        description = 'Timer for PIN diode counting',
        tangodevice = tango_analog + 'pin_diode_timer',
        unit = 's',
        fmtstr = '%d',
    ),
    pinstate = device('nicos.devices.tango.NamedDigitalInput',
        description = 'Status of PIN diode counting',
        tangodevice = tango_digital + 'pin_diode_status',
        mapping = {
            'counting': 1,
            'ready': 0
        },
        fmtstr = '%s',
        lowlevel = True,
    ),
    pincontrol = device('nicos.devices.tango.DigitalInput',
        description = 'Status control of PIN diode counting',
        tangodevice = tango_digital + 'pin_diode_control',
        lowlevel = True,
    ),
    singledetectors = device('nicos_mlz.galaxi.devices.pindiode.SingleDetectors',
        description = 'Integrated PIN diode values',
        pintimer = 'pintimer',
        pinstate = 'pinstate',
        pincontrol = 'pincontrol',
        pindiodes = [
            'ionichamber1_int', 'ionichamber2_int', 'pindiode1_int',
            'pindiodecal_int', 'pindiodesample_int'
        ],
    ),
    ionichamber1 = device('nicos.devices.tango.AnalogInput',
        description = 'Ionisation chamber 1',
        tangodevice = tango_analog + 'ionisation_chamber1',
    ),
    ionichamber1_int = device('nicos.devices.tango.AnalogInput',
        description = 'Integral of ionisation chamber 1',
        tangodevice = tango_analog + 'ionisation_chamber1_int',
        fmtstr = '%.10g',
    ),
    ionichamber1_off = device('nicos.devices.tango.AnalogOutput',
        description = 'Offset ionisation chamber 1',
        tangodevice = tango_analog + 'ionisation_chamber1_offset',
    ),
    ionichamber2 = device('nicos.devices.tango.AnalogInput',
        description = 'Ionisation chamber 2',
        tangodevice = tango_analog + 'ionisation_chamber2',
    ),
    ionichamber2_int = device('nicos.devices.tango.AnalogInput',
        description = 'Integral of ionisation chamber 2',
        tangodevice = tango_analog + 'ionisation_chamber2_int',
        fmtstr = '%.10g',
    ),
    ionichamber2_off = device('nicos.devices.tango.AnalogOutput',
        description = 'Offset of ionisation chamber 2',
        tangodevice = tango_analog + 'ionisation_chamber2_offset',
    ),
    pindiode1_move = device('nicos.devices.tango.NamedDigitalOutput',
        description = 'Moving of PIN diode in chamber 1',
        tangodevice = tango_digital + 'AbsorberPlate16',
        mapping = {
            'in': 1,
            'out': 0
        },
        fmtstr = '%s',
    ),
    pindiode1 = device('nicos.devices.tango.AnalogInput',
        description = 'PIN diode in chamber 1',
        tangodevice = tango_analog + 'pin_diode1',
    ),
    pindiode1_int = device('nicos.devices.tango.AnalogInput',
        description = 'Integral of PIN diode in chamber 1',
        tangodevice = tango_analog + 'pin_diode1_int',
        fmtstr = '%.10g',
    ),
    pindiode1_off = device('nicos.devices.tango.AnalogOutput',
        description = 'Offset of PIN diode in chamber 1',
        tangodevice = tango_analog + 'pin_diode1_offset',
    ),
    pindiodesample_move = device('nicos.devices.tango.NamedDigitalOutput',
        description = 'Moving of PIN diode behind sample place',
        tangodevice = tango_digital + 'PinDiode',
        mapping = {
            'in': 1,
            'out': 2
        },
        fmtstr = '%s',
    ),
    pindiodesample = device('nicos.devices.tango.AnalogInput',
        description = 'PIN diode behind sample place',
        tangodevice = tango_analog + 'pin_diode_sample',
    ),
    pindiodesample_int = device('nicos.devices.tango.AnalogInput',
        description = 'Integral of PIN diode behind sample place',
        tangodevice = tango_analog + 'pin_diode_sample_int',
        fmtstr = '%.10g',
    ),
    pindiodesample_off = device('nicos.devices.tango.AnalogOutput',
        description = 'Offset of PIN diode behind sample place',
        tangodevice = tango_analog + 'pin_diode_sample_offset',
    ),
    pindiodecal = device('nicos.devices.tango.AnalogInput',
        description = 'Calibrated PIN diode at sample place',
        tangodevice = tango_analog + 'pin_diode_calibrated',
    ),
    pindiodecal_int = device('nicos.devices.tango.AnalogInput',
        description = 'Integral of calibrated PIN diode at sample place',
        tangodevice = tango_analog + 'pin_diode_calibrated_int',
        fmtstr = '%.10g',
    ),
    pindiodecal_off = device('nicos.devices.tango.AnalogOutput',
        description = 'Offset of calibrated PIN diode at sample place',
        tangodevice = tango_analog + 'pin_diode_calibrated_offset',
    ),
)
