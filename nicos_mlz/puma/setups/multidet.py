#  -*- coding: utf-8 -*-

description = 'Multidetector motors'

includes = ['system', 'motorbus10']

excludes = []

group = 'lowlevel'

modules = ['nicos_mlz.puma.commands']

nethost = 'pumasrv.puma.frm2'

inner_slope = 4061.72
outer_slope = 4709.53
rd_refswitch = 'high'
rd_refdirection = 'upper'
rd_zerosteps = 500000
rd_refstep = 500
rd_inner_speed = 65
rd_outer_speed = 77

rg_slope = -948
rg_refswitch = 'high'
rg_refdirection = 'lower'
rg_zerosteps = 500000
rg_refstep = 100

level = False

devices = dict(
    # Detectors
    st_rd11 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 71,
        slope = inner_slope,
        unit = 'deg',
        abslimits = (-40, -13),
        refpos = 446056,  # 343173,# 656827, 343173, -38.611, 500000, # -13.281 deg
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_inner_speed,
        lowlevel = True,
    ),
    st_rd10 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 73,
        slope = outer_slope,
        unit = 'deg',
        abslimits = (-37.5, -10.6),
        refpos = 448817,  # 329524, -36.198, 670476, 500000, # -10.868 deg
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_outer_speed,
        lowlevel = True,
    ),
    st_rd9 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 75,
        slope = inner_slope,
        unit = 'deg',
        abslimits = (-35, -8.2),
        refpos = 465914,  # 363031, # -33.722, 636969, 500000, # -8.392
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_inner_speed,
        lowlevel = True,
    ),
    st_rd8 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 77,
        slope = outer_slope,
        unit = 'deg',
        abslimits = (-32.5, -5.8),
        refpos = 472087,  # 352794, # -31.257, 647206, 500000, # -5.927
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_outer_speed,
        lowlevel = True,
    ),
    st_rd7 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 79,
        slope = inner_slope,
        unit = 'deg',
        abslimits = (-30, -3.4),
        refpos = 485126,  # 382243, # -28.992, 500000, # 617757, # -3.662
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_inner_speed,
        lowlevel = True,
    ),
    st_rd6 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 81,
        slope = outer_slope,
        unit = 'deg',
        abslimits = (-27.5, -1),
        refpos = 494490,  # 375202, # -26.499, 500000, # 624798, # -1.170
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_outer_speed,
        lowlevel = True,
    ),
    st_rd5 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 83,
        slope = inner_slope,
        unit = 'deg',
        abslimits = (-25.0, 1.4),
        refpos = 505231,  # 402348, # -24.042, 500000, # 597652, # 1.288 deg
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_inner_speed,
        lowlevel = True,
    ),
    st_rd4 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 85,
        slope = outer_slope,
        unit = 'deg',
        abslimits = (-22.5, 3.8),
        refpos = 517322,  # 398030, # -21.6518,  500000, # 601970, # 3.678 deg
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_outer_speed,
        lowlevel = True,
    ),
    st_rd3 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 87,
        slope = inner_slope,
        unit = 'deg',
        refpos = 525045,  # 422161, # -19.164, 500000, # 577839, # 6.166 deg
        abslimits = (-20.0, 6.2),
        zerosteps = rd_zerosteps,
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_inner_speed,
        lowlevel = True,
    ),
    st_rd2 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 89,
        slope = outer_slope,
        unit = 'deg',
        abslimits = (-17.5, 8.6),
        refpos = 539904,  # 420611, # -16.857, 500000, # 579389, # 8.473 deg
        zerosteps = rd_zerosteps,
        # The card has firmware version 65 instead of 58 and it seems that the
        # limit switch order has been changed
        refswitch = rd_refswitch,
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_outer_speed,
        lowlevel = True,
    ),
    st_rd1 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 91,
        slope = inner_slope,
        unit = 'deg',
        abslimits = (-15, 11),
        refpos = 544679,  # 441625, # -14.372, 500000, # 558375 # 11 deg
        zerosteps = rd_zerosteps,
        # The card has firmware version 65 instead of 58 and it seems that the
        # limit switch order has been changed
        refswitch = rd_refswitch,  # 'high',
        refdirection = rd_refdirection,
        refstep = rd_refstep,
        speed = rd_inner_speed,
        lowlevel = True,
    ),
    rd11 = device('nicos.devices.generic.Axis',
        description = 'Detector 11 position',
        motor = 'st_rd11',
        obs = [],
        precision = 0.01,
        offset = 0, # 38.611, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd10 = device('nicos.devices.generic.Axis',
        description = 'Detector 10 position',
        motor = 'st_rd10',
        obs = [],
        precision = 0.01,
        offset = 0, # 36.198, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd9 = device('nicos.devices.generic.Axis',
        description = 'Detector 9 position',
        motor = 'st_rd9',
        obs = [],
        precision = 0.01,
        offset = 0, # 33.722, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd8 = device('nicos.devices.generic.Axis',
        description = 'Detector 8 position',
        motor = 'st_rd8',
        obs = [],
        precision = 0.01,
        offset = 0, # 31.257, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd7 = device('nicos.devices.generic.Axis',
        description = 'Detector 7 position',
        motor = 'st_rd7',
        obs = [],
        precision = 0.01,
        offset = 0, # 28.892,
        maxtries = 1,
        lowlevel = level,
    ),
    rd6 = device('nicos.devices.generic.Axis',
        description = 'Detector 6 position',
        motor = 'st_rd6',
        obs = [],
        precision = 0.01,
        offset = 0, # 26.499, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd5 = device('nicos.devices.generic.Axis',
        description = 'Detector 5 position',
        motor = 'st_rd5',
        obs = [],
        precision = 0.01,
        offset = 0, # 24.042, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd4 = device('nicos.devices.generic.Axis',
        description = 'Detector 4 position',
        motor = 'st_rd4',
        obs = [],
        precision = 0.01,
        offset = 0, # 21.652, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd3 = device('nicos.devices.generic.Axis',
        description = 'Detector 3 position',
        motor = 'st_rd3',
        obs = [],
        precision = 0.01,
        offset = 0, # 19.164, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd2 = device('nicos.devices.generic.Axis',
        description = 'Detector 2 position',
        motor = 'st_rd2',
        obs = [],
        precision = 0.01,
        offset = 0, # 16.857, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    rd1 = device('nicos.devices.generic.Axis',
        description = 'Detector 1 position',
        motor = 'st_rd1',
        obs = [],
        precision = 0.01,
        offset = 0, # 14.372, # 0
        maxtries = 1,
        lowlevel = level,
    ),
    # Guides
    st_rg11 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 72,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 509262,  # 506892, # -7.27, 500000, 7576,#509167, #-9.67,/#/
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg10 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 74,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 508380,  # 506864,  # -7.24, 500000, 7529,#508286, #-8.74,/#/
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg9 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 76,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 507992,  # 506759, # -7.13, 500000, 7520,#508181, #-8.63,/#/
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg8 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 78,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 508257,  # 506740, # -7.11, 500000, 7534,#508304, #-8.76/#/,
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg7 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 80,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 506674,  # 506958, #-7.34, 500000, 7620,
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg6 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 82,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 506134,  # 506845, # -7.22, 500000, 7516,#506086, #-6.42/#/,
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg5 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 84,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 505603,  # 507025, # -7.41, 500000, 7552,#505840, #-6.16/#/,
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg4 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 86,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 505043,  # 506655, # -7.02, 500000, 7578,#506181, #-6.52/#/,
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg3 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 88,
        slope = rg_slope,
        unit = 'deg',
        abslimits = (-10, 20),
        refpos = 505252,  # 506674, # -7.04, 500000, 7518,#506199, #-6.54/#/,
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg2 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 90,
        slope = rg_slope,
        unit = 'deg',
        refpos = 507366,  # 506892, # -7.27, 500000, 7591,#507366, #-7.77/#/,
        abslimits = (-10, 20),
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    st_rg1 = device('nicos_mlz.puma.devices.ipc_puma.ReferenceMotor',
        bus = 'motorbus10',
        addr = 92,
        slope = rg_slope,
        unit = 'deg',
        refpos = 508371,  # 507328, # -7.73, 500000, 7550,#508560, #-9.03/#/,
        abslimits = (-10, 20),
        zerosteps = rg_zerosteps,
        refswitch = rg_refswitch,
        refdirection = rg_refdirection,
        refstep = rg_refstep,
        lowlevel = True,
    ),
    rg11 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 11 guide',
        motor = 'st_rg11',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.27,
        maxtries = 1,
        lowlevel = level,
    ),
    rg10 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 10 guide',
        motor = 'st_rg10',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.24,
        maxtries = 1,
        lowlevel = level,
    ),
    rg9 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 9 guide',
        motor = 'st_rg9',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.13,
        maxtries = 1,
        lowlevel = level,
    ),
    rg8 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 8 guide',
        motor = 'st_rg8',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.11,
        maxtries = 1,
        lowlevel = level,
    ),
    rg7 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 7 guide',
        motor = 'st_rg7',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.34,
        maxtries = 1,
        lowlevel = level,
    ),
    rg6 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 6 guide',
        motor = 'st_rg6',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.22,
        maxtries = 1,
        lowlevel = level,
    ),
    rg5 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 5 guide',
        motor = 'st_rg5',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.41,
        maxtries = 1,
        lowlevel = level,
    ),
    rg4 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 4 guide',
        motor = 'st_rg4',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.02,
        maxtries = 1,
        lowlevel = level,
    ),
    rg3 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 3 guide',
        motor = 'st_rg3',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.04,
        maxtries = 1,
        lowlevel = level,
    ),
    rg2 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 2 guide',
        motor = 'st_rg2',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.27,
        maxtries = 1,
        lowlevel = level,
    ),
    rg1 = device('nicos.devices.generic.Axis',
        description = 'Rotation of the detector 1 guide',
        motor = 'st_rg1',
        obs = [],
        precision = 0.01,
        offset = 0, # 7.73,
        maxtries = 1,
        lowlevel = level,
    ),
    med = device('nicos_mlz.puma.devices.multidetector.PumaMultiDetectorLayout',
        description = 'PUMA multi detector',
        rotdetector = ['rd1', 'rd2', 'rd3', 'rd4', 'rd5', 'rd6', 'rd7', 'rd8',
                       'rd9', 'rd10', 'rd11'],
        rotguide = ['rg1', 'rg2', 'rg3', 'rg4', 'rg5', 'rg6', 'rg7', 'rg8',
                    'rg9', 'rg10', 'rg11'],
        refgap = 4.,
        att = 'att',
    ),
)
