description = 'Polarizer devices'

group = 'lowlevel'

motor_class = 'devices.generic.VirtualMotor'

ps_class = 'devices.generic.ManualMove'

devices = dict(
    polarizer_tilt_m = device(motor_class,
                              description = 'Polarizer tilt motor',
                              abslimits = (-247.512, 247.512),
                              unit = 'deg',
                              lowlevel = True,
                             ),
    polarizer_tilt = device('devices.generic.Axis',
                            description = 'Polarizer tilt',
                            motor = 'polarizer_tilt_m',
                            coder = 'polarizer_tilt_m',
                            backlash = 0.5,
                            precision = 0.001,
                            fmtstr = '%.3f',
                            unit = 'deg',
                           ),
    polarizer_y_m = device(motor_class,
                           description = 'Polarizer y translation motor',
                           abslimits = (-5000., 5000.),
                           unit = 'mm',
                           lowlevel = True,
                          ),
    polarizer_y = device('devices.generic.Axis',
                         description = 'Polarizer y translation',
                         motor = 'polarizer_y_m',
                         coder = 'polarizer_y_m',
                         backlash = 0.5,
                         precision = 0.01,
                         fmtstr = '%.2f',
                         unit = 'mm',
                         lowlevel = True,
                        ),
    attenuator = device('devices.generic.Switcher',
                        description = 'Different attenuators in beam',
                        moveable = 'polarizer_y',
                        mapping = {'polarized': -36,
                                   'None': 0,
                                   'lambda': 36,
                                  },
                        precision = 0.1,
                        unit = '',
                       ),
    fl2comp = device(ps_class,
                     description = 'Power supply for the polarizer',
                     abslimits = (-10, 10),
                     unit = 'A',
                     lowlevel = True,
                    ),
    fl2flip = device(ps_class,
                     description = 'Power supply for the polarizer',
                     abslimits = (-10, 10),
                     unit = 'A',
                     lowlevel = True,
                    ),
    fl1rf = device(ps_class,
                   description = 'Power supply for the polarizer',
                   abslimits = (-10, 10),
                   unit = 'A',
                   lowlevel = True,
                  ),
    fl1grad = device(ps_class,
                     description = 'Power supply for the polarizer',
                     abslimits = (-10, 10),
                     unit = 'A',
                     lowlevel = True,
                    ),
    polarizer = device('devices.generic.MultiSwitcher',
                       description = 'Polarizer device',
                       moveables = ['fl2comp', 'fl2flip', 'fl1rf', 'fl1grad', ],
                       mapping = {'off': [0, 0, 0.016, 0.35],
                                  'on': [0, 0, 1.2, 0.35],
                                 },
                       precision = (0.01, 0.01, 0.0001, 0.001),
                      ),
)
