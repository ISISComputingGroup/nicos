description = 'base setup for all instrument configurations'
group = 'lowlevel'

includes = ['system', 'slits', 'sample', 'nl6', 'reactor']

devices = dict(
    MonoToni = device('devices.vendor.toni.ModBus',
                      tacodevice = '//mirasrv/mira/rs232/monotoni',
                      lowlevel = True,
                     ),

    atten1   = device('devices.vendor.toni.Valve',
                      description = 'Attenuator 1 (factor 6 at 4.5 Ang) in the beam?',
                      bus = 'MonoToni',
                      addr = 241,
                      channel = 6,
                      states = ['out', 'in'],
                      warnlimits = ('out', 'out'),
                     ),
    atten2   = device('devices.vendor.toni.Valve',
                      description = 'Attenuator 2 (factor 36 at 4.5 Ang) in the beam?',
                      bus = 'MonoToni',
                      addr = 241,
                      channel = 7,
                      states = ['out', 'in'],
                      warnlimits = ('out', 'out'),
                     ),
    lamfilter = device('devices.vendor.toni.Valve',
                       description = 'Beryllium filter in the beam?',
                       bus = 'MonoToni',
                       addr = 241,
                       channel = 4,
                       states = ['in', 'out'],
                       warnlimits = ('in', 'in'),
                      ),
    FOL       = device('devices.vendor.toni.Valve',
                       description = 'Frame overlap mirror in the beam?',
                       lowlevel = True,   # not used currently
                       bus = 'MonoToni',
                       addr = 241,
                       channel = 0,
                       states = ['out', 'in'],
                      ),
    flip1     = device('devices.vendor.toni.Valve',
                       description = 'Flipper in MIRA-1 shielding in the beam?',
                       lowlevel = True,  # not used currently
                       bus = 'MonoToni',
                       addr = 241,
                       channel = 3,
                       states = ['out', 'in'],
                      ),
    flip2     = device('devices.vendor.toni.Valve',
                       description = 'Flipper and guide field in MIRA-2 shielding table in the beam?',
                       bus = 'MonoToni',
                       addr = 241,
                       channel = 3,
                       states = ['in', 'out'],
                      ),
    ms2pos    = device('devices.vendor.toni.Valve',
                       description = 'Slit after MIRA-2 shielding exit in the beam?',
                       bus = 'MonoToni',
                       addr = 241,
                       channel = 5,
                       states = ['out', 'in'],
                       warnlimits = ('in', 'in'),
                      ),

    Shutter   = device('mira.shutter.Shutter',
                       description = 'MIRA shutter position',
                       tacodevice = '//mirasrv/mira/io/shutteropen',
                       pollinterval = 1,
                       output = '//mirasrv/mira/io/closeshutter',
                       mapping = {'closed': 0, 'open': 1},
                       warnlimits = ('open', 'open'),
                      ),

    PSDGas = device('devices.taco.NamedDigitalInput',
                    description = 'Sensor to indicate low pressure in counting gas of CASCADE',
                    mapping = {'empty': 0, 'okay': 1},
                    warnlimits = ('okay', 'okay'),
                    pollinterval = 10,
                    maxage = 30,
                    tacodevice = '//mirasrv/mira/io/psdgas',
                   ),

    Cooling   = device('devices.taco.NamedDigitalInput',
                       description = 'Sensor for MIRA cooling water filling level',
                       mapping = {'refill': 0, 'okay': 1},
                       warnlimits = ('okay', 'okay'),
                       pollinterval = 10,
                       maxage = 30,
                       tacodevice = '//mirasrv/mira/io/cooling',
                      ),
    CoolTemp  = device('devices.taco.AnalogInput',
                       description = 'Temperature of MIRA cooling water',
                       tacodevice = '//mirasrv/mira/i7000/coolingtemp',
                       warnlimits = (10, 30),
                       pollinterval = 10,
                       maxage = 30,
                      ),

    # LeckToni  = device('devices.vendor.toni.ModBus',
    #                    tacodevice = '//mirasrv/mira/rs232/lecktoni',
    #                    lowlevel = True,
    #                   ),

    # Leckmon   = device('devices.vendor.toni.Leckmon',
    #                    bus = 'LeckToni',
    #                    addr = 0x17,
    #                    unit = '',
    #                   ),
)
