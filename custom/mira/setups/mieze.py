description = 'MIEZE measurement setup'
group = 'basic'

includes = ['cascade', 'relay']
modules = ['nicos.mira.mieze']

devices = dict(
    mieze    = device('mira.mieze.MiezeMaster',
                      description = 'master MIEZE control device',
                     ),

    amp1     = device('mira.rfcircuit.GeneratorDevice',
                      description = 'amplitude of first function generator',
                      tacodevice = '//mirasrv/mira/hp33220a_1/amp',
                      abslimits = (0, 1),
                     ),
    amp2     = device('mira.rfcircuit.GeneratorDevice',
                      description = 'amplitude of second function generator',
                      tacodevice = '//mirasrv/mira/hp33220a_2/amp',
                      abslimits = (0, 1),
                     ),
    amp3     = device('mira.rfcircuit.GeneratorDevice',
                      description = 'amplitude of third function generator',
                      tacodevice = '//mirasrv/mira/hp33220a_3/amp',
                      warnlimits = (4.999, 5.001),
                      abslimits = (0, 5),
                     ),

    freq1    = device('mira.rfcircuit.GeneratorDevice',
                      description = 'frequency of first function generator',
                      tacodevice = '//mirasrv/mira/hp33220a_1/freq',
                      fmtstr = '%.0f',
                      abslimits = (0, 80000000),
                     ),
    freq2    = device('mira.rfcircuit.GeneratorDevice',
                      description = 'frequency of second function generator',
                      tacodevice = '//mirasrv/mira/hp33220a_2/freq',
                      fmtstr = '%.0f',
                      abslimits = (0, 80000000),
                     ),
    freq3    = device('mira.rfcircuit.GeneratorDevice',
                      description = 'frequency of third function generator',
                      tacodevice = '//mirasrv/mira/hp33220a_3/freq',
                      fmtstr = '%.0f',
                      abslimits = (0, 80000000),
                     ),

    coilamp1 = device('devices.taco.AnalogInput',
                      description = 'readout of amplitude in first RF coil',
                      tacodevice = '//mirasrv/mira/tds2014/ch1_pk2pk',
                      pollinterval = 5,
                      maxage = 6,
                     ),
    coilamp2 = device('devices.taco.AnalogInput',
                      description = 'readout of amplitude in second RF coil',
                      tacodevice = '//mirasrv/mira/tds2014/ch2_pk2pk',
                      pollinterval = 5,
                      maxage = 6,
                     ),

    rf1      = device('mira.rfcircuit.RFCurrent',
                      description = 'automatic control of current in first RF coil',
                      unit = 'V',
                      abslimits = (0, 10),
                      amplitude = 'amp1',
                      readout = 'coilamp1',
                     ),
    rf2      = device('mira.rfcircuit.RFCurrent',
                      description = 'automatic control of current in second RF coil',
                      unit = 'V',
                      abslimits = (0, 10),
                      amplitude = 'amp2',
                      readout = 'coilamp2',
                     ),

    dc1      = device('devices.taco.CurrentSupply',
                      description = 'current in first DC coil',
                      tacodevice = '//mirasrv/mira/heinzinger/current',
                      abslimits = (0, 100),
                      ramp = 0,
                      variance = 5,
                      fmtstr = '%.2f',
                     ),
#    dc1      = device('mira.heinzinger.HeinzingerViaHPE',
#                      tacodevice = '//mirasrv/mira/network/rs7_2',
#                      abslimits = (0, 30),
#                      scale = 5.,
#                      fmtstr = '%.2f',
#                     ),
    dc2      = device('mira.heinzinger.HeinzingerViaHPE',
                      description = 'current in second DC coil',
                      tacodevice = '//mirasrv/mira/network/rs7_3',
                      abslimits = (0, 30),
                      scale = 5.,
                      fmtstr = '%.2f',
                     ),
#    dc2      = device('mira.ntn.Supply',
#                      tacodevice = '//mirasrv/mira/ntn14000m/current',
#                      abslimits = (0, 100),
#                      ramp = 0,
#                      variance = 5,
#                      offset = 0,
#                      readoffset = 0.348132,
#                      readslope = 1.02465,
#                      fmtstr = '%.2f',
#                     ),
#    dc2      = device('mira.ntn.FUG',
#                      tacodevice = '//mirasrv/mira/network/rs7_2',
#                      abslimits = (0, 100),
#                      readoffset = 0.348132,
#                      readslope = 1.02465,
#                      fmtstr = '%.2f',
#                     )

    cc1      = device('devices.taco.CurrentSupply',
                      description = 'current in first coupling coil',
                      tacodevice = '//mirasrv/mira/ttiql/tti1_1',
                      abslimits = (0, 2),
                     ),
    cc2      = device('devices.taco.CurrentSupply',
                      description = 'current in second coupling coil',
                      tacodevice = '//mirasrv/mira/ttiql/tti1_2',
                      abslimits = (0, 2),
                     ),

    fp1      = device('devices.taco.AnalogInput',
                      description = 'forward power in first RF amplifier',
                      tacodevice = '//mirasrv/mira/ag1016/fp1',
                     ),
    rp1      = device('devices.taco.AnalogInput',
                      description = 'reverse power in first RF amplifier',
                      tacodevice = '//mirasrv/mira/ag1016/rp1',
                      warnlimits = (0, 20),
                     ),
    fp2      = device('devices.taco.AnalogInput',
                      description = 'forward power in second RF amplifier',
                      tacodevice = '//mirasrv/mira/ag1016/fp2',
                     ),
    rp2      = device('devices.taco.AnalogInput',
                      description = 'reverse power in second RF amplifier',
                      tacodevice = '//mirasrv/mira/ag1016/rp2',
                      warnlimits = (0, 20),
                     ),

    Cbox1    = device('mira.beckhoff.DigitalOutput',
                      description = 'first capacitor box',
                      tacodevice = '//mirasrv/mira/modbus/beckhoff',
                      startoffset = 8,
                      bitwidth = 32,
                     ),
    Cbox2    = device('mira.beckhoff.DigitalOutput',
                      description = 'second capacitor box',
                      tacodevice = '//mirasrv/mira/modbus/beckhoff',
                      startoffset = 40,
                      bitwidth = 32,
                     ),

)
