description = 'chopper setup'
includes = ['system']

devices = dict(
    ch           = device('toftof.chopper.Controller',
                          tacodevice = '//toftofsrv/toftof/rs232/ifchoppercontrol',
                          speed_accuracy = 2,
                          phase_accuracy = 10,
                          ch5_90deg_offset = 0,
                          timeout = 600,
                          pollinterval = 10,
                          maxage = 12),
    chWL         = device('toftof.chopper.Wavelength',
                          chopper = 'ch',
                          abslimits = (0.2, 16.0),
                          pollinterval = 10,
                          maxage = 12),
    chSpeed      = device('toftof.chopper.Speed',
                          chopper = 'ch',
                          abslimits = (0, 22000.),
                          pollinterval = 10,
                          maxage = 12),
    chRatio      = device('toftof.chopper.Ratio',
                          chopper = 'ch',
                          pollinterval = 10,
                          maxage = 12),
    chCRC        = device('toftof.chopper.CRC',
                          requires = {'level': 'admin'},
                          chopper = 'ch',
                          pollinterval = 10,
                          maxage = 12),
    chST         = device('toftof.chopper.SlitType',
                          requires = {'level': 'admin'},
                          chopper = 'ch',
                          pollinterval = 10,
                          maxage = 12),
    chDS         = device('toftof.chopper.SpeedReadout',
                          chopper = 'ch',
                          fmtstr = '[%7.2f, %7.2f, %7.2f, %7.2f, %7.2f, %7.2f, %7.2f]',
                          pollinterval = 10,
                          maxage = 12),

    chdelaybus   = device('devices.vendor.toni.ModBus',
                          tacodevice = 'toftof/rs232/ifchdelay',
                          lowlevel = True),
    chdelay      = device('devices.vendor.toni.DelayBox',
                          requires = {'level': 'admin'},
                          bus = 'chdelaybus',
                          addr = 0xF1,
                          unit = '', # ???
                          fmtstr = '%d'),
)
