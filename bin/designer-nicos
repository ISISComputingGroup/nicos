#!/usr/bin/env python

import sys, os
from os import path
thisfile = path.abspath(__file__)
while path.islink(thisfile):
    thisfile = path.join(path.dirname(thisfile), os.readlink(thisfile))

os.environ['PYTHONPATH'] = path.normpath(path.dirname(thisfile) + '/..')
os.environ['PYQTDESIGNERPATH'] = \
    path.normpath(path.dirname(thisfile) + '/../nicos/guisupport')

modules = []
args = []
for item in sys.argv[1:]:
    if item.startswith('nicos.') and not item.endswith('.ui'):
        modules.append(item)
    else:
        args.append(item)

os.environ['NICOSDESIGNER_MODULES'] = ':'.join(modules)

if sys.platform == 'darwin':
    os.environ['PATH'] = \
        '/Developer/Applications/Qt/Designer.app/Contents/MacOS/'
    os.execvp('Designer', ['Designer'] + args)
else:
    os.execvp('designer', ['designer'] + args)
