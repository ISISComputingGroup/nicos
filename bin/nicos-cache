#!/usr/bin/env python

import sys
from os import path
sys.path.insert(0, path.dirname(path.dirname(path.realpath(__file__))))

import optparse
from nicos.core.sessions.simple import NoninteractiveSession

parser = optparse.OptionParser()
parser.add_option('-d', '--daemon', dest='daemon', action='store_true',
                  help='daemonize the cache process')
parser.add_option('-S', '--setup', action='store', dest='setupname',
                  default='cache',
                  help="name of the setup, default is 'cache'")
parser.add_option('--clear', dest='clear', action='store_true',
                  default=False,
                  help='clear the whole cache')
opts, args = parser.parse_args()

if opts.clear:
    args.append('clear')

NoninteractiveSession.run('cache', 'Server', setupname=opts.setupname,
                          daemon=opts.daemon, start_args=args)
